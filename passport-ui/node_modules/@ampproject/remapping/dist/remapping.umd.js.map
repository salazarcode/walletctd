{"version":3,"file":"remapping.umd.js","sources":["../node_modules/sourcemap-codec/src/sourcemap-codec.ts","../src/defaults.ts","../src/decode-source-map.ts","../src/original-source.ts","../node_modules/@jridgewell/resolve-uri/src/resolve-uri.ts","../src/resolve.ts","../src/binary-search.ts","../src/fast-string-array.ts","../src/source-map-tree.ts","../src/strip-filename.ts","../src/build-source-map-tree.ts","../src/source-map.ts","../src/remapping.ts"],"sourcesContent":["export type SourceMapSegment =\n\t| [number]\n\t| [number, number, number, number]\n\t| [number, number, number, number, number];\nexport type SourceMapLine = SourceMapSegment[];\nexport type SourceMapMappings = SourceMapLine[];\n\nconst charToInteger: { [charCode: number]: number } = {};\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfor (let i = 0; i < chars.length; i++) {\n\tcharToInteger[chars.charCodeAt(i)] = i;\n}\n\nexport function decode(mappings: string): SourceMapMappings {\n\tconst decoded: SourceMapMappings = [];\n\tlet line: SourceMapLine = [];\n\tconst segment: SourceMapSegment = [\n\t\t0, // generated code column\n\t\t0, // source file index\n\t\t0, // source code line\n\t\t0, // source code column\n\t\t0, // name index\n\t];\n\n\tlet j = 0;\n\tfor (let i = 0, shift = 0, value = 0; i < mappings.length; i++) {\n\t\tconst c = mappings.charCodeAt(i);\n\n\t\tif (c === 44) { // \",\"\n\t\t\tsegmentify(line, segment, j);\n\t\t\tj = 0;\n\n\t\t} else if (c === 59) { // \";\"\n\t\t\tsegmentify(line, segment, j);\n\t\t\tj = 0;\n\t\t\tdecoded.push(line);\n\t\t\tline = [];\n\t\t\tsegment[0] = 0;\n\n\t\t} else {\n\t\t\tlet integer = charToInteger[c];\n\t\t\tif (integer === undefined) {\n\t\t\t\tthrow new Error('Invalid character (' + String.fromCharCode(c) + ')');\n\t\t\t}\n\n\t\t\tconst hasContinuationBit = integer & 32;\n\n\t\t\tinteger &= 31;\n\t\t\tvalue += integer << shift;\n\n\t\t\tif (hasContinuationBit) {\n\t\t\t\tshift += 5;\n\t\t\t} else {\n\t\t\t\tconst shouldNegate = value & 1;\n\t\t\t\tvalue >>>= 1;\n\n\t\t\t\tif (shouldNegate) {\n\t\t\t\t\tvalue = value === 0 ? -0x80000000 : -value;\n\t\t\t\t}\n\n\t\t\t\tsegment[j] += value;\n\t\t\t\tj++;\n\t\t\t\tvalue = shift = 0; // reset\n\t\t\t}\n\t\t}\n\t}\n\n\tsegmentify(line, segment, j);\n\tdecoded.push(line);\n\n\treturn decoded;\n}\n\nfunction segmentify(line: SourceMapSegment[], segment: SourceMapSegment, j: number) {\n\t// This looks ugly, but we're creating specialized arrays with a specific\n\t// length. This is much faster than creating a new array (which v8 expands to\n\t// a capacity of 17 after pushing the first item), or slicing out a subarray\n\t// (which is slow). Length 4 is assumed to be the most frequent, followed by\n\t// length 5 (since not everything will have an associated name), followed by\n\t// length 1 (it's probably rare for a source substring to not have an\n\t// associated segment data).\n\tif (j === 4) line.push([segment[0], segment[1], segment[2], segment[3]]);\n\telse if (j === 5) line.push([segment[0], segment[1], segment[2], segment[3], segment[4]]);\n\telse if (j === 1) line.push([segment[0]]);\n}\n\nexport function encode(decoded: SourceMapMappings): string {\n\tlet sourceFileIndex = 0;  // second field\n\tlet sourceCodeLine = 0;   // third field\n\tlet sourceCodeColumn = 0; // fourth field\n\tlet nameIndex = 0;        // fifth field\n\tlet mappings = '';\n\n\tfor (let i = 0; i < decoded.length; i++) {\n\t\tconst line = decoded[i];\n\t\tif (i > 0) mappings += ';';\n\t\tif (line.length === 0) continue;\n\n\t\tlet generatedCodeColumn = 0; // first field\n\n\t\tconst lineMappings: string[] = [];\n\n\t\tfor (const segment of line) {\n\t\t\tlet segmentMappings = encodeInteger(segment[0] - generatedCodeColumn);\n\t\t\tgeneratedCodeColumn = segment[0];\n\n\t\t\tif (segment.length > 1) {\n\t\t\t\tsegmentMappings +=\n\t\t\t\t\tencodeInteger(segment[1] - sourceFileIndex) +\n\t\t\t\t\tencodeInteger(segment[2] - sourceCodeLine) +\n\t\t\t\t\tencodeInteger(segment[3] - sourceCodeColumn);\n\n\t\t\t\tsourceFileIndex = segment[1];\n\t\t\t\tsourceCodeLine = segment[2];\n\t\t\t\tsourceCodeColumn = segment[3];\n\t\t\t}\n\n\t\t\tif (segment.length === 5) {\n\t\t\t\tsegmentMappings += encodeInteger(segment[4] - nameIndex);\n\t\t\t\tnameIndex = segment[4];\n\t\t\t}\n\n\t\t\tlineMappings.push(segmentMappings);\n\t\t}\n\n\t\tmappings += lineMappings.join(',');\n\t}\n\n\treturn mappings;\n}\n\nfunction encodeInteger(num: number): string {\n\tvar result = '';\n\tnum = num < 0 ? (-num << 1) | 1 : num << 1;\n\tdo {\n\t\tvar clamped = num & 31;\n\t\tnum >>>= 5;\n\t\tif (num > 0) {\n\t\t\tclamped |= 32;\n\t\t}\n\t\tresult += chars[clamped];\n\t} while (num > 0);\n\n\treturn result;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Creates a brand new (prototype-less) object with the enumerable-own\n * properties of `target`. Any enumerable-own properties from `source` which\n * are not present on `target` will be copied as well.\n */\nexport default function defaults<T, U>(target: T, source: U): T & U {\n  return Object.assign(Object.create(null), source, target) as T & U;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { decode } from 'sourcemap-codec';\nimport defaults from './defaults';\nimport { DecodedSourceMap, RawSourceMap, SourceMapInput, SourceMapSegment } from './types';\n\n/**\n * Decodes an input sourcemap into a `DecodedSourceMap` sourcemap object.\n *\n * Valid input maps include a `DecodedSourceMap`, a `RawSourceMap`, or JSON\n * representations of either type.\n */\nexport default function decodeSourceMap(map: SourceMapInput): DecodedSourceMap {\n  if (typeof map === 'string') {\n    map = JSON.parse(map) as DecodedSourceMap | RawSourceMap;\n  }\n\n  let { mappings } = map;\n  if (typeof mappings === 'string') {\n    mappings = decode(mappings);\n  } else {\n    // Clone the Line so that we can sort it. We don't want to mutate an array\n    // that we don't own directly.\n    mappings = mappings.map(cloneSegmentLine);\n  }\n  // Sort each Line's segments. There's no guarantee that segments are sorted for us,\n  // and even Chrome's implementation sorts:\n  // https://cs.chromium.org/chromium/src/third_party/devtools-frontend/src/front_end/sdk/SourceMap.js?l=507-508&rcl=109232bcf479c8f4ef8ead3cf56c49eb25f8c2f0\n  mappings.forEach(sortSegments);\n\n  return defaults({ mappings }, map);\n}\n\nfunction cloneSegmentLine(segments: SourceMapSegment[]): SourceMapSegment[] {\n  return segments.slice();\n}\n\nfunction sortSegments(segments: SourceMapSegment[]): void {\n  segments.sort(segmentComparator);\n}\n\nfunction segmentComparator(a: SourceMapSegment, b: SourceMapSegment): number {\n  return a[0] - b[0];\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SourceMapSegmentObject } from './types';\n\n/**\n * A \"leaf\" node in the sourcemap tree, representing an original, unmodified\n * source file. Recursive segment tracing ends at the `OriginalSource`.\n */\nexport default class OriginalSource {\n  content: string | null;\n  filename: string;\n\n  constructor(filename: string, content: string | null) {\n    this.filename = filename;\n    this.content = content;\n  }\n\n  /**\n   * Tracing a `SourceMapSegment` ends when we get to an `OriginalSource`,\n   * meaning this line/column location originated from this source file.\n   */\n  traceSegment(line: number, column: number, name: string): SourceMapSegmentObject {\n    return { column, line, name, source: this };\n  }\n}\n","type WhatWgUrl = import('url').URL;\ninterface Url extends WhatWgUrl {\n  new (input: string, base?: string): WhatWgUrl;\n}\ndeclare var URL: unknown;\n\n/* istanbul ignore next */\nconst Url = (typeof URL !== 'undefined' ? URL : require('url').URL) as Url;\n\n// Matches \"..\", which must be preceeded by \"/\" or the start of the string, and\n// must be followed by a \"/\". We do not eat the following \"/\", so that the next\n// iteration can match on it.\nconst parentRegex = /(^|\\/)\\.\\.(?=\\/|$)/g;\n\nfunction isAbsoluteUrl(url: string): boolean {\n  try {\n    return !!new Url(url);\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Creates a directory name that is guaranteed to not be in `str`.\n */\nfunction uniqInStr(str: string): string {\n  let uniq = String(Math.random()).slice(2);\n  while (str.indexOf(uniq) > -1) {\n    /* istanbul ignore next */\n    uniq += uniq;\n  }\n  return uniq;\n}\n\n/**\n * Removes the filename from the path (everything trailing the last \"/\"). This\n * is only safe to call on a path, never call with an absolute or protocol\n * relative URL.\n */\nfunction stripPathFilename(path: string): string {\n  path = normalizePath(path);\n  const index = path.lastIndexOf('/');\n  return path.slice(0, index + 1);\n}\n\n/**\n * Normalizes a protocol-relative URL, but keeps it protocol relative by\n * stripping out the protocl before returning it.\n */\nfunction normalizeProtocolRelative(input: string, absoluteBase: string): string {\n  const { href, protocol } = new Url(input, absoluteBase);\n  return href.slice(protocol.length);\n}\n\n/**\n * Normalizes a simple path (one that has no \"..\"s, or is absolute so \"..\"s can\n * be normalized absolutely).\n */\nfunction normalizeSimplePath(input: string): string {\n  const { href } = new Url(input, 'https://foo.com/');\n  return href.slice('https://foo.com/'.length);\n}\n\n/**\n * Normalizes a path, ensuring that excess \"..\"s are preserved for relative\n * paths in the output.\n *\n * If the input is absolute, this will return an absolutey normalized path, but\n * it will not have a leading \"/\".\n *\n * If the input has a leading \"..\", the output will have a leading \"..\".\n *\n * If the input has a leading \".\", the output will not have a leading \".\"\n * unless there are too many \"..\"s, in which case there will be a leading \"..\".\n */\nfunction normalizePath(input: string): string {\n  // If there are no \"..\"s, we can treat this as if it were an absolute path.\n  // The return won't be an absolute path, so it's easy.\n  if (!parentRegex.test(input)) return normalizeSimplePath(input);\n\n  // We already found one \"..\". Let's see how many there are.\n  let total = 1;\n  while (parentRegex.test(input)) total++;\n\n  // If there are \"..\"s, we need to prefix the the path with the same number of\n  // unique directories. This is to ensure that we \"remember\" how many parent\n  // directories we are accessing. Eg, \"../../..\" must keep 3, and \"foo/../..\"\n  // must keep 1.\n  const uniqDirectory = `z${uniqInStr(input)}/`;\n\n  // uniqDirectory is just a \"z\", followed by numbers, followed by a \"/\". So\n  // generating a runtime regex from it is safe. We'll use this search regex to\n  // strip out our uniq directory names and insert any needed \"..\"s.\n  const search = new RegExp(`^(?:${uniqDirectory})*`);\n\n  // Now we can resolve the total path. If there are excess \"..\"s, they will\n  // eliminate one or more of the unique directories we prefix with.\n  const relative = normalizeSimplePath(uniqDirectory.repeat(total) + input);\n\n  // We can now count the number of unique directories that were eliminated. If\n  // there were 3, and 1 was eliminated, we know we only need to add 1 \"..\". If\n  // 2 were eliminated, we need to insert 2 \"..\"s. If all 3 were eliminated,\n  // then we need 3, etc. This replace is guranteed to match (it may match 0 or\n  // more times), and we can count the total match to see how many were eliminated.\n  return relative.replace(search, (all: string) => {\n    const leftover = all.length / uniqDirectory.length;\n    return '../'.repeat(total - leftover);\n  });\n}\n\n/**\n * Attempts to resolve `input` URL relative to `base`.\n */\nexport default function resolve(input: string, base: string | undefined): string {\n  if (!base) base = '';\n\n  // Absolute URLs are very easy to resolve right.\n  if (isAbsoluteUrl(input)) return new Url(input).href;\n\n  if (base) {\n    // Absolute URLs are easy...\n    if (isAbsoluteUrl(base)) return new Url(input, base).href;\n\n    // If base is protocol relative, we'll resolve with it but keep the result\n    // protocol relative.\n    if (base.startsWith('//')) return normalizeProtocolRelative(input, `https:${base}`);\n  }\n\n  // Normalize input, but keep it protocol relative. We know base doesn't supply\n  // a protocol, because that would have been handled above.\n  if (input.startsWith('//')) return normalizeProtocolRelative(input, 'https://foo.com/');\n\n  // We now know that base (if there is one) and input are paths. We've handled\n  // both absolute and protocol-relative variations above.\n\n  // Absolute paths don't need any special handling, because they cannot have\n  // extra \".\" or \"..\"s. That'll all be stripped away. Input takes priority here,\n  // because if input is an absolute path, base path won't affect it in any way.\n  if (input.startsWith('/')) return '/' + normalizeSimplePath(input);\n\n  // Since input and base are paths, we need to join them to do any further\n  // processing. Paths are joined at the directory level, so we need to remove\n  // the base's filename before joining. We also know that input does not have a\n  // leading slash, and that the stripped base will have a trailing slash if\n  // there are any directories (or it'll be empty).\n  const joined = stripPathFilename(base) + input;\n\n  // If base is an absolute path, then input will be relative to it.\n  if (base.startsWith('/')) return '/' + normalizeSimplePath(joined);\n\n  // We now know both base (if there is one) and input are relative paths.\n  const relative = normalizePath(joined);\n\n  // If base started with a leading \".\", or there is no base and input started\n  // with a \".\", then we need to ensure that the relative path starts with a\n  // \".\". We don't know if relative starts with a \"..\", though, so check before\n  // prepending.\n  if ((base || input).startsWith('.') && !relative.startsWith('.')) {\n    return './' + relative;\n  }\n\n  return relative;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport resolveUri from '@jridgewell/resolve-uri';\n\nexport default function resolve(input: string, base: string | undefined): string {\n  // The base is always treated as a directory, if it's not empty.\n  // https://github.com/mozilla/source-map/blob/8cb3ee57/lib/util.js#L327\n  // https://github.com/chromium/chromium/blob/da4adbb3/third_party/blink/renderer/devtools/front_end/sdk/SourceMap.js#L400-L401\n  if (base && !base.endsWith('/')) base += '/';\n\n  return resolveUri(input, base);\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A binary search implementation that returns the index if a match is found,\n * or the negated index of where the `needle` should be inserted.\n *\n * The `comparator` callback receives both the `item` under comparison and the\n * needle we are searching for. It must return `0` if the `item` is a match,\n * any negative number if `item` is too small (and we must search after it), or\n * any positive number if the `item` is too large (and we must search before\n * it).\n *\n * If no match is found, a negated index of where to insert the `needle` is\n * returned. This negated index is guaranteed to be less than 0. To insert an\n * item, negate it (again) and splice:\n *\n * ```js\n * const array = [1, 3];\n * const needle = 2;\n * const index = binarySearch(array, needle, (item, needle) => item - needle);\n *\n * assert.equal(index, -2);\n * assert.equal(~index, 1);\n * array.splice(~index, 0, needle);\n * assert.deepEqual(array, [1, 2, 3]);\n * ```\n */\nexport default function binarySearch<T, S>(\n  haystack: ArrayLike<T>,\n  needle: S,\n  comparator: (item: T, needle: S) => number\n): number {\n  let low = 0;\n  let high = haystack.length - 1;\n\n  while (low <= high) {\n    const mid = low + ((high - low) >> 1);\n    const cmp = comparator(haystack[mid], needle);\n\n    if (cmp === 0) {\n      return mid;\n    }\n\n    if (cmp < 0) {\n      low = mid + 1;\n    } else {\n      high = mid - 1;\n    }\n  }\n\n  return ~low;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * FastStringArray acts like a `Set` (allowing only one occurrence of a string\n * `key`), but provides the index of the `key` in the backing array.\n *\n * This is designed to allow synchronizing a second array with the contents of\n * the backing array, like how `sourcesContent[i]` is the source content\n * associated with `source[i]`, and there are never duplicates.\n */\nexport default class FastStringArray {\n  private indexes: { [key: string]: number };\n  array: ReadonlyArray<string>;\n\n  constructor() {\n    this.indexes = Object.create(null) as { [key: string]: number };\n    this.array = [];\n  }\n\n  /**\n   * Puts `key` into the backing array, if it is not already present. Returns\n   * the index of the `key` in the backing array.\n   */\n  put(key: string): number {\n    const { array, indexes } = this;\n    // The key may or may not be present. If it is present, it's a number.\n    let index = indexes[key] as number | undefined;\n\n    // If it's not yet present, we need to insert it and track the index in the\n    // indexes.\n    if (index === undefined) {\n      index = indexes[key] = array.length;\n      (array as string[]).push(key);\n    }\n\n    return index;\n  }\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport binarySearch from './binary-search';\nimport defaults from './defaults';\nimport FastStringArray from './fast-string-array';\nimport OriginalSource from './original-source';\nimport { DecodedSourceMap, SourceMapSegment, SourceMapSegmentObject } from './types';\n\ntype Sources = OriginalSource | SourceMapTree;\n\n/**\n * SourceMapTree represents a single sourcemap, with the ability to trace\n * mappings into its child nodes (which may themselves be SourceMapTrees).\n */\nexport default class SourceMapTree {\n  map: DecodedSourceMap;\n  sources: Sources[];\n\n  constructor(map: DecodedSourceMap, sources: Sources[]) {\n    this.map = map;\n    this.sources = sources;\n  }\n\n  /**\n   * traceMappings is only called on the root level SourceMapTree, and begins\n   * the process of resolving each mapping in terms of the original source\n   * files.\n   */\n  traceMappings(): DecodedSourceMap {\n    const mappings: SourceMapSegment[][] = [];\n    const names = new FastStringArray();\n    const sources = new FastStringArray();\n    const sourcesContent: (string | null)[] = [];\n    const { mappings: rootMappings, names: rootNames } = this.map;\n\n    for (let i = 0; i < rootMappings.length; i++) {\n      const segments = rootMappings[i];\n      const tracedSegments: SourceMapSegment[] = [];\n\n      for (let j = 0; j < segments.length; j++) {\n        const segment = segments[j];\n\n        // 1-length segments only move the current generated column, there's no\n        // source information to gather from it.\n        if (segment.length === 1) continue;\n        const source = this.sources[segment[1]];\n\n        const traced = source.traceSegment(\n          segment[2],\n          segment[3],\n          segment.length === 5 ? rootNames[segment[4]] : ''\n        );\n        if (!traced) continue;\n\n        // So we traced a segment down into its original source file. Now push a\n        // new segment pointing to this location.\n        const { column, line, name } = traced;\n        const { content, filename } = traced.source;\n\n        // Store the source location, and ensure we keep sourcesContent up to\n        // date with the sources array.\n        const sourceIndex = sources.put(filename);\n        sourcesContent[sourceIndex] = content;\n\n        // This looks like unnecessary duplication, but it noticeably increases\n        // performance. If we were to push the nameIndex onto length-4 array, v8\n        // would internally allocate 22 slots! That's 68 wasted bytes! Array\n        // literals have the same capacity as their length, saving memory.\n        if (name) {\n          tracedSegments.push([segment[0], sourceIndex, line, column, names.put(name)]);\n        } else {\n          tracedSegments.push([segment[0], sourceIndex, line, column]);\n        }\n      }\n\n      mappings.push(tracedSegments);\n    }\n\n    // TODO: Make all sources relative to the sourceRoot.\n\n    return defaults(\n      {\n        mappings,\n        names: names.array,\n        sources: sources.array,\n        sourcesContent,\n      },\n      this.map\n    );\n  }\n\n  /**\n   * traceSegment is only called on children SourceMapTrees. It recurses down\n   * into its own child SourceMapTrees, until we find the original source map.\n   */\n  traceSegment(line: number, column: number, name: string): SourceMapSegmentObject | null {\n    const { mappings, names } = this.map;\n\n    // It's common for parent sourcemaps to have pointers to lines that have no\n    // mapping (like a \"//# sourceMappingURL=\") at the end of the child file.\n    if (line >= mappings.length) return null;\n\n    const segments = mappings[line];\n    const index = binarySearch(segments, column, segmentComparator);\n\n    // If we can't find an segment that lines up to this column, then we can't\n    // trace it further.\n    if (index < 0) return null;\n    const segment = segments[index];\n\n    // 1-length segments only move the current generated column, there's no\n    // source information to gather from it.\n    if (segment.length === 1) return null;\n    const source = this.sources[segment[1]];\n\n    // So now we can recurse down, until we hit the original source file.\n    return source.traceSegment(\n      segment[2],\n      segment[3],\n      // A child map's recorded name for this segment takes precedence over the\n      // parent's mapped name. Imagine a mangler changing the name over, etc.\n      segment.length === 5 ? names[segment[4]] : name\n    );\n  }\n}\n\nfunction segmentComparator(segment: SourceMapSegment, column: number): number {\n  return segment[0] - column;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Removes the filename from a path.\n */\nexport default function stripFilename(path: string | undefined): string {\n  if (!path) return '';\n  const index = path.lastIndexOf('/');\n  return path.slice(0, index + 1);\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport decodeSourceMap from './decode-source-map';\nimport OriginalSource from './original-source';\nimport resolve from './resolve';\nimport SourceMapTree from './source-map-tree';\nimport stripFilename from './strip-filename';\nimport { SourceMapInput, SourceMapLoader } from './types';\n\nfunction asArray<T>(value: T | T[]): T[] {\n  if (Array.isArray(value)) return value;\n  return [value];\n}\n\n/**\n * Recursively builds a tree structure out of sourcemap files, with each node\n * being either an `OriginalSource` \"leaf\" or a `SourceMapTree` composed of\n * `OriginalSource`s and `SourceMapTree`s.\n *\n * Every sourcemap is composed of a collection of source files and mappings\n * into locations of those source files. When we generate a `SourceMapTree` for\n * the sourcemap, we attempt to load each source file's own sourcemap. If it\n * does not have an associated sourcemap, it is considered an original,\n * unmodified source file.\n */\nexport default function buildSourceMapTree(\n  input: SourceMapInput | SourceMapInput[],\n  loader: SourceMapLoader,\n  relativeRoot?: string\n): SourceMapTree {\n  const maps = asArray(input).map(decodeSourceMap);\n  const map = maps.pop()!;\n\n  for (let i = 0; i < maps.length; i++) {\n    if (maps[i].sources.length !== 1) {\n      throw new Error(\n        `Transformation map ${i} must have exactly one source file.\\n` +\n          'Did you specify these with the most recent transformation maps first?'\n      );\n    }\n  }\n\n  const { sourceRoot, sources, sourcesContent } = map;\n\n  const children = sources.map((sourceFile: string | null, i: number) => {\n    // Each source file is loaded relative to the sourcemap's own sourceRoot,\n    // which is itself relative to the sourcemap's parent.\n    const uri = resolve(sourceFile || '', resolve(sourceRoot || '', stripFilename(relativeRoot)));\n\n    // Use the provided loader callback to retrieve the file's sourcemap.\n    // TODO: We should eventually support async loading of sourcemap files.\n    const sourceMap = loader(uri);\n\n    // If there is no sourcemap, then it is an unmodified source file.\n    if (!sourceMap) {\n      // The source file's actual contents must be included in the sourcemap\n      // (done when generating the sourcemap) for it to be included as a\n      // sourceContent in the output sourcemap.\n      const sourceContent = sourcesContent ? sourcesContent[i] : null;\n      return new OriginalSource(uri, sourceContent);\n    }\n\n    // Else, it's a real sourcemap, and we need to recurse into it to load its\n    // source files.\n    return buildSourceMapTree(decodeSourceMap(sourceMap), loader, uri);\n  });\n\n  let tree = new SourceMapTree(map, children);\n  for (let i = maps.length - 1; i >= 0; i--) {\n    tree = new SourceMapTree(maps[i], [tree]);\n  }\n  return tree;\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { encode } from 'sourcemap-codec';\nimport { DecodedSourceMap, RawSourceMap } from './types';\n\n/**\n * A SourceMap v3 compatible sourcemap, which only includes fields that were\n * provided to it.\n */\nexport default class SourceMap implements RawSourceMap {\n  file?: string | null;\n  mappings: string;\n  sourceRoot?: string;\n  names: string[];\n  sources: (string | null)[];\n  sourcesContent?: (string | null)[];\n  version: 3;\n\n  constructor(map: DecodedSourceMap, excludeContent: boolean) {\n    this.version = 3; // SourceMap spec says this should be first.\n    if ('file' in map) this.file = map.file;\n    this.mappings = encode(map.mappings);\n    this.names = map.names;\n\n    // TODO: We first need to make all source URIs relative to the sourceRoot\n    // before we can support a sourceRoot.\n    // if ('sourceRoot' in map) this.sourceRoot = map.sourceRoot;\n\n    this.sources = map.sources;\n    if (!excludeContent && 'sourcesContent' in map) this.sourcesContent = map.sourcesContent;\n  }\n\n  toString(): string {\n    return JSON.stringify(this);\n  }\n}\n","/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport buildSourceMapTree from './build-source-map-tree';\nimport SourceMap from './source-map';\nimport { SourceMapInput, SourceMapLoader } from './types';\n\n/**\n * Traces through all the mappings in the root sourcemap, through the sources\n * (and their sourcemaps), all the way back to the original source location.\n *\n * `loader` will be called every time we encounter a source file. If it returns\n * a sourcemap, we will recurse into that sourcemap to continue the trace. If\n * it returns a falsey value, that source file is treated as an original,\n * unmodified source file.\n *\n * Pass `excludeContent` content to exclude any self-containing source file\n * content from the output sourcemap.\n */\nexport default function remapping(\n  input: SourceMapInput | SourceMapInput[],\n  loader: SourceMapLoader,\n  excludeContent?: boolean\n): SourceMap {\n  const graph = buildSourceMapTree(input, loader);\n  return new SourceMap(graph.traceMappings(), !!excludeContent);\n}\n"],"names":["resolve","resolveUri","segmentComparator"],"mappings":"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"}